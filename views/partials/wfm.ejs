<div id="wfm-view" style="display: none; height: 100%;">
    
    <!-- MENU SUPERIOR -->
    <div class="map-toolbar" style="background: #222; margin-bottom: 20px;">
        <button onclick="toggleWfmTab('curves')" style="background:#5653d4; color:white; border:none; padding:8px 15px; border-radius:4px;">üìà 1. Curvas</button>
        <button onclick="toggleWfmTab('shrinkage')" style="background:#5653d4; color:white; border:none; padding:8px 15px; border-radius:4px; margin-left: 10px;">üìâ 2. Fatores de Corre√ß√£o</button>
        <button onclick="toggleWfmTab('simulation')" style="background:#e1b12c; color:black; border:none; padding:8px 15px; border-radius:4px; margin-left: 10px; font-weight: bold;">üßÆ 3. Simula√ß√£o</button>
    </div>

    <!-- ABA 1: CURVAS -->
    <div id="wfm-tab-curves" class="wfm-tab">
        <div style="display: flex; justify-content: space-between;">
            <h2>Curvas de Distribui√ß√£o</h2>
            <button onclick="openNewCurveModal()" style="padding: 10px; background: #4cd137; border: none; border-radius: 4px;">+ Nova Curva</button>
        </div>
        <table style="width: 100%; border-collapse: collapse; margin-top: 20px;">
            <thead><tr style="border-bottom:1px solid #555"><th style="text-align:left; padding:10px">Nome</th><th>Canal</th><th>A√ß√£o</th></tr></thead>
            <tbody id="curves-list-body"></tbody>
        </table>
    </div>

    <!-- ABA 2: SHRINKAGE -->
    <div id="wfm-tab-shrinkage" class="wfm-tab" style="display: none;">
        <div style="display: flex; justify-content: space-between;">
            <h2>Fatores de Corre√ß√£o (Perdas)</h2>
            <button onclick="openShrinkageModal()" style="padding: 10px; background: #4cd137; border: none; border-radius: 4px;">+ Novo Perfil</button>
        </div>
        <table style="width: 100%; border-collapse: collapse; margin-top: 20px;">
            <thead><tr style="border-bottom:1px solid #555"><th style="text-align:left; padding:10px">Nome do Perfil</th><th>Total Perdas (%)</th><th>A√ß√£o</th></tr></thead>
            <tbody id="shrinkage-list-body"></tbody>
        </table>
    </div>

    <!-- ABA 3: SIMULA√á√ÉO -->
    <div id="wfm-tab-simulation" class="wfm-tab" style="display: none;">
        <h2>Nova Simula√ß√£o</h2>
        <div style="background: #2b2b40; padding: 20px; border-radius: 8px; display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px;">
            <input type="text" id="sim-desc" placeholder="Nome da Simula√ß√£o" style="grid-column: span 3;">
            <input type="number" id="sim-vol" placeholder="Volume Total (Ex: 5000)">
            <input type="number" id="sim-aht" placeholder="TMA (segundos)">
            <input type="number" id="sim-sla" placeholder="Meta SLA % (Ex: 80)">
            <select id="sim-curve"><option>Carregando Curvas...</option></select>
            <select id="sim-shrink"><option>Carregando Fatores...</option></select>
            <button onclick="runSimulation()" style="background: #e1b12c; color: black; font-weight: bold; border: none; padding: 10px; border-radius: 4px;">CALCULAR AGORA</button>
        </div>
        <div id="simulation-result" style="margin-top: 20px; display: none;">
            <h3>Resultado do Dimensionamento</h3>
            <table style="width: 100%; border-collapse: collapse;">
                <thead style="background: #111;">
                    <tr>
                        <th style="padding:10px">Hor√°rio</th>
                        <th style="padding:10px">Volume</th>
                        <th style="padding:10px; color:#e1b12c">Necessidade Contrata√ß√£o</th>
                        <th style="padding:10px">Escalado (Manual)</th>
                    </tr>
                </thead>
                <tbody id="sim-result-body"></tbody>
            </table>
        </div>
    </div>
</div>

<!-- MODAIS -->

<!-- 1. NOVA CURVA -->
<div id="new-curve-modal" class="modal-overlay">
    <div class="modal-window">
        <div class="modal-header"><span>Nova Curva</span><span onclick="closeCurveModal()" style="cursor:pointer">X</span></div>
        <div class="modal-body">
            <input type="text" id="curve-name" placeholder="Nome (ex: Segunda Voz)" style="width: 100%; margin-bottom: 10px;">
            <select id="curve-channel" style="width: 100%; margin-bottom: 20px;">
                <option value="VOICE_IN">Voz Receptivo</option>
                <option value="VOICE_OUT">Voz Ativo</option>
                <option value="WHATSAPP">WhatsApp</option>
            </select>
            <button onclick="createCurveStub()" style="width:100%; padding:10px; background:#4cd137; border:none; border-radius:4px; font-weight:bold;">CRIAR</button>
        </div>
    </div>
</div>

<!-- 2. EDITAR CURVA (LAYOUT FLEX CORRIGIDO) -->
<div id="edit-curve-modal" class="modal-overlay">
    <div class="modal-window" style="width: 600px; height: 85vh; display: flex; flex-direction: column; overflow: hidden;">
        <div class="modal-header">
            <span id="edit-curve-title">Editando Curva</span>
            <span onclick="closeEditCurveModal()" style="cursor:pointer;">X</span>
        </div>
        <div style="padding: 20px; background: #2b2b40; border-bottom: 1px solid #444; flex-shrink: 0;">
            <input type="hidden" id="edit-curve-id"> 
            <p style="font-size: 0.9em; color: #aaa; margin: 0;">Total da Amostra: <strong id="total-volume" style="color: #fff; font-size: 1.2em;">0</strong></p>
        </div>
        <div style="flex: 1; overflow-y: auto; padding: 0 20px; background: #2b2b40;">
            <table style="width: 100%; border-collapse: separate; border-spacing: 0;">
                <thead>
                    <tr>
                        <th style="padding: 10px; position: sticky; top: 0; background-color: #2b2b40; z-index: 10; border-bottom: 2px solid #555; text-align: left;">Hor√°rio</th>
                        <th style="padding: 10px; position: sticky; top: 0; background-color: #2b2b40; z-index: 10; border-bottom: 2px solid #555; text-align: left;">Volume</th>
                        <th style="padding: 10px; position: sticky; top: 0; background-color: #2b2b40; z-index: 10; border-bottom: 2px solid #555; text-align: left;">% Calc.</th>
                    </tr>
                </thead>
                <tbody id="curve-intervals-body"></tbody>
            </table>
        </div>
        <div style="padding: 20px; border-top: 1px solid #444; background: #222; flex-shrink: 0; display: flex; gap: 10px;">
            <button onclick="deleteCurve()" style="flex: 1; padding: 10px; background: #ff4757; color: white; border: none; font-weight: bold; border-radius: 4px; cursor: pointer;">üóëÔ∏è EXCLUIR</button>
            <button onclick="saveCurveDetails()" style="flex: 2; padding: 10px; background: #5653d4; color: white; border: none; font-weight: bold; border-radius: 4px; cursor: pointer;">SALVAR ALTERA√á√ïES</button>
        </div>
    </div>
</div>

<!-- 3. NOVO SHRINKAGE -->
<div id="shrinkage-modal" class="modal-overlay">
    <div class="modal-window">
        <div class="modal-header"><span>Novo Fator de Corre√ß√£o</span><span onclick="closeShrinkModal()" style="cursor:pointer">X</span></div>
        <div class="modal-body">
            <input type="text" id="shrink-name" placeholder="Nome (Ex: Padr√£o Janeiro)" style="width:100%; margin-bottom:15px;">
            <div id="shrink-items-container"></div>
            <button onclick="addShrinkRow()" style="background:#333; color:white; border:none; padding:5px; margin-bottom:15px; width:100%">+ Adicionar Item</button>
            <button onclick="saveShrinkage()" style="width:100%; padding:10px; background:#4cd137; border:none; border-radius:4px; font-weight:bold;">SALVAR</button>
        </div>
    </div>
</div>